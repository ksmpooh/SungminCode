library(tidyverse)
library(readxl)

setwd("~/Desktop/KCDC/??????????????????????????????/Pangenome/????????????/???????????????/")

df <-read_xlsx("????????????????????????????????? ????????????????????????????????? ???????????????????????????_KPP_250825.xlsx",col_names = F,sheet = 3)
head(df)
ref <- read_xlsx("~/Desktop/KCDC/??????????????????????????????/Pangenome/???????????????????????????????????????????????????/?????????????????????????????????/Pangenome????????????????????????????????????_???????????????????????????.xlsx")
head(ref)

head(ref)
ref %>% mutate(ref = str_replace_all(SampleID,'PG',"")) -> ref

df  %>% mutate(ref = str_split_fixed(...1,"-",3)[,3]) %>% left_join(ref) %>% #head()
  select(...1,Name,Sex,Age,Date) %>%
  rename(id=...1) %>% 
  mutate(name = if_else(
      str_length(Name) == 2,         # 이름이 2글자면
      str_sub(Name, 1, 1),           # 앞 1글자만
      str_sub(Name, 1, 2)            # 그렇지 않으면(3글자 이상) 앞 2글자
    )) %>%
  mutate(Sex = paste0(Sex,"자")) %>% writexl::write_xlsx("addinfo.xlsx")

